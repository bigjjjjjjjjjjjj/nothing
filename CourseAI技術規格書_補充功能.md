# CourseAI æŠ€è¡“è¦æ ¼æ›¸ - è£œå……åŠŸèƒ½

**ç‰ˆæœ¬ï¼š** v1.1
**æ–°å¢æ—¥æœŸï¼š** 2024-11-17
**è£œå……èªªæ˜ï¼š** ç´°ç·»ç¯„åœåˆ†é¡ + è€å¸«é‡é»æç¤ºè¨˜éŒ„

---

## 1. æ›´ç´°ç·»çš„é¡Œç›®ç¯„åœåˆ†é¡

### 1.1 å•é¡Œæè¿°

åŸæœ¬çš„ç¯„åœåˆ†é¡å¤ªç²—ï¼ˆä¾‹å¦‚ã€Œç¬¬ä¸‰ç« ã€ã€ã€Œç¬¬å››ç« ã€ï¼‰ï¼Œä½†å¯¦éš›ä¸Šä¸€å ‚èª²ä¸æœƒä¸Šå®Œæ•´ç« ï¼Œå¯èƒ½åªä¸Šï¼š
- 3.1 äºŒå…ƒæ¨¹å®šç¾©
- 3.2 äºŒå…ƒæ¨¹æ€§è³ªçš„å‰åŠéƒ¨åˆ†

å› æ­¤éœ€è¦æ›´ç´°ç·»çš„å–®å…ƒåŠƒåˆ†ã€‚

### 1.2 æ›´æ–°å¾Œçš„ API è¦æ ¼

#### API: å»ºè­°é¡Œç›®ç”Ÿæˆç¯„åœï¼ˆæ›´æ–°ç‰ˆï¼‰

```
POST /courses/{course_id}/suggest-quiz-scopes
```

**Response ç¯„ä¾‹ï¼ˆæ›´æ–°ç‰ˆï¼‰ï¼š**

```json
{
  "suggested_scopes": [
    {
      "scope_id": "scope_1",
      "label": "æ•´å ‚èª²ç¨‹",
      "description": "æœ¬æ¬¡èª²ç¨‹å®Œæ•´å…§å®¹",
      "estimated_questions": 12,
      "coverage": "all"
    },
    {
      "scope_id": "scope_2",
      "label": "3.1 äºŒå…ƒæ¨¹çš„å®šç¾©",
      "description": "åŒ…å«ï¼šæ¨¹çš„åŸºæœ¬æ¦‚å¿µã€äºŒå…ƒæ¨¹çš„å®šç¾©ã€æ€§è³ª",
      "slide_pages": [3, 4, 5],
      "transcript_timestamps": ["00:05:23", "00:08:45", "00:12:30"],
      "estimated_questions": 5,
      "keywords": ["äºŒå…ƒæ¨¹", "ç¯€é»", "å­ç¯€é»", "æ ¹ç¯€é»"],
      "coverage": "section"
    },
    {
      "scope_id": "scope_3",
      "label": "3.2 äºŒå…ƒæ¨¹çš„è¡¨ç¤ºæ³•",
      "description": "åŒ…å«ï¼šé™£åˆ—è¡¨ç¤ºæ³•ã€éˆçµè¡¨ç¤ºæ³•",
      "slide_pages": [6, 7],
      "transcript_timestamps": ["00:15:30", "00:20:15"],
      "estimated_questions": 4,
      "keywords": ["é™£åˆ—", "éˆçµä¸²åˆ—", "æŒ‡æ¨™"],
      "coverage": "section"
    },
    {
      "scope_id": "scope_4",
      "label": "4.1 æ¨¹çš„èµ°è¨ª - å‰åºèµ°è¨ª",
      "description": "åƒ…åŒ…å«å‰åºèµ°è¨ªçš„æ¦‚å¿µèˆ‡å¯¦ä½œ",
      "slide_pages": [8, 9],
      "transcript_timestamps": ["00:25:00", "00:30:45"],
      "estimated_questions": 4,
      "keywords": ["å‰åºèµ°è¨ª", "éè¿´", "æ ¹-å·¦-å³"],
      "coverage": "subsection"
    },
    {
      "scope_id": "scope_5",
      "label": "è€å¸«èªªæœƒè€ƒçš„éƒ¨åˆ†",
      "description": "è€å¸«æ˜ç¢ºæåˆ°ã€Œæœƒè€ƒã€ã€ã€Œå¾ˆé‡è¦ã€ã€ã€Œæ³¨æ„ã€çš„å…§å®¹",
      "slide_pages": [3, 5, 8],
      "transcript_timestamps": ["00:08:45", "00:20:15", "00:35:20"],
      "teacher_hints": [
        {
          "timestamp": "00:08:45",
          "hint_text": "é€™å€‹å®šç¾©å¾ˆé‡è¦ï¼Œè€ƒè©¦æœƒè€ƒ",
          "related_concept": "äºŒå…ƒæ¨¹å®šç¾©",
          "slide_page": 3
        },
        {
          "timestamp": "00:20:15",
          "hint_text": "æ³¨æ„é€™è£¡ï¼Œé™£åˆ—è¡¨ç¤ºæ³•çš„ç´¢å¼•é—œä¿‚è¦è¨˜æ¸…æ¥š",
          "related_concept": "é™£åˆ—è¡¨ç¤ºæ³•",
          "slide_page": 7
        },
        {
          "timestamp": "00:35:20",
          "hint_text": "å‰åºèµ°è¨ªçš„é †åºä¸€å®šè¦è¨˜å¾—ï¼Œé€™å€‹å¸¸è€ƒ",
          "related_concept": "å‰åºèµ°è¨ª",
          "slide_page": 8
        }
      ],
      "estimated_questions": 6,
      "coverage": "important"
    }
  ],
  "default_scope": "scope_1",
  "recommendation": "å»ºè­°å…ˆè¤‡ç¿’ã€Œè€å¸«èªªæœƒè€ƒçš„éƒ¨åˆ†ã€ï¼Œå†ä¾åºç·´ç¿’å„å°ç¯€å…§å®¹"
}
```

### 1.3 LLM Prompt è¨­è¨ˆ

**åˆ†æèª²ç¨‹å…§å®¹ä¸¦è­˜åˆ¥ç´°ç·»å–®å…ƒï¼š**

```python
prompt = f"""
åˆ†æä»¥ä¸‹èª²ç¨‹å…§å®¹ï¼Œè­˜åˆ¥å‡ºç´°ç·»çš„å­¸ç¿’å–®å…ƒã€‚

è¬›ç¾©å…§å®¹ï¼ˆå«é ç¢¼ã€æ¨™é¡Œï¼‰ï¼š
{slides_with_structure}

èª²å ‚èªéŸ³è½‰éŒ„ï¼ˆå«æ™‚é–“æˆ³è¨˜ï¼‰ï¼š
{transcript_with_timestamps}

è«‹å®Œæˆä»¥ä¸‹ä»»å‹™ï¼š

1. è­˜åˆ¥è¬›ç¾©çš„ç« ç¯€çµæ§‹ï¼š
   - ç«  (Chapter): ä¾‹å¦‚ã€Œç¬¬ä¸‰ç« ï¼šæ¨¹ç‹€çµæ§‹ã€
   - ç¯€ (Section): ä¾‹å¦‚ã€Œ3.1 äºŒå…ƒæ¨¹çš„å®šç¾©ã€
   - å°ç¯€ (Subsection): ä¾‹å¦‚ã€Œ3.1.1 åŸºæœ¬æ¦‚å¿µã€

2. åˆ†æèªéŸ³è½‰éŒ„ï¼Œåˆ¤æ–·è€å¸«å¯¦éš›ä¸Šèª²çš„ç¯„åœï¼š
   - å“ªäº›å–®å…ƒæœ‰è©³ç´°è¬›è§£ï¼ˆå°æ‡‰åˆ°å¤§é‡è½‰éŒ„å…§å®¹ï¼‰
   - å“ªäº›å–®å…ƒåªæ˜¯ç°¡å–®å¸¶é

3. è­˜åˆ¥è€å¸«çš„é‡é»æç¤ºèªï¼š
   - ã€Œé€™å€‹æœƒè€ƒã€ã€ã€Œè€ƒè©¦é‡é»ã€ã€ã€Œä¸€å®šè¦è¨˜å¾—ã€
   - ã€Œå¾ˆé‡è¦ã€ã€ã€Œæ³¨æ„é€™è£¡ã€ã€ã€Œå¸¸è€ƒã€
   - ã€ŒæœŸä¸­è€ƒæœƒå‡ºã€ã€ã€Œé€™é¡Œè¦æœƒå¯«ã€
   è¨˜éŒ„ï¼šæ™‚é–“æˆ³è¨˜ã€æç¤ºæ–‡å­—ã€å°æ‡‰çš„æ¦‚å¿µã€å°æ‡‰çš„è¬›ç¾©é ç¢¼

4. å»ºè­°é¡Œç›®ç”Ÿæˆç¯„åœï¼š
   - æ•´å ‚èª²
   - æ¯å€‹ã€Œç¯€ã€(Section) ç¨ç«‹ä¸€å€‹ç¯„åœ
   - è‹¥æŸç¯€å…§å®¹å¾ˆå¤šï¼Œå¯æ‹†æˆã€Œå°ç¯€ã€
   - ã€Œè€å¸«èªªæœƒè€ƒçš„éƒ¨åˆ†ã€ï¼ˆæ ¹æ“šæç¤ºèªè­˜åˆ¥ï¼‰

è«‹ä»¥ JSON æ ¼å¼å›å‚³ï¼š
{{
  "course_structure": {{
    "chapters": [
      {{
        "chapter_number": "3",
        "chapter_title": "æ¨¹ç‹€çµæ§‹",
        "sections": [
          {{
            "section_number": "3.1",
            "section_title": "äºŒå…ƒæ¨¹çš„å®šç¾©",
            "slide_pages": [3, 4, 5],
            "transcript_coverage": {{"start": "00:05:23", "end": "00:14:50"}},
            "keywords": ["äºŒå…ƒæ¨¹", "ç¯€é»", "å­ç¯€é»"],
            "subsections": [
              {{
                "subsection_number": "3.1.1",
                "subsection_title": "åŸºæœ¬æ¦‚å¿µ",
                "slide_pages": [3, 4]
              }}
            ]
          }}
        ]
      }}
    ]
  }},
  "teacher_hints": [
    {{
      "timestamp": "00:08:45",
      "hint_text": "é€™å€‹å®šç¾©å¾ˆé‡è¦ï¼Œè€ƒè©¦æœƒè€ƒ",
      "hint_type": "exam",  // exam, important, attention, common_mistake
      "related_concept": "äºŒå…ƒæ¨¹å®šç¾©",
      "slide_page": 3,
      "confidence": 0.95
    }}
  ],
  "suggested_scopes": [...]
}}
"""
```

### 1.4 å‰ç«¯ UI æ›´æ–°

**é¡Œç›®ç¯„åœé¸æ“‡ä»‹é¢ï¼ˆæ›´æ–°ç‰ˆï¼‰ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“ é¸æ“‡é¡Œç›®ç”Ÿæˆç¯„åœ                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚ ğŸ¯ æ¨è–¦ç¯„åœ                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚ â­ è€å¸«èªªæœƒè€ƒçš„éƒ¨åˆ† (6 é¡Œ)          â”‚  â”‚
â”‚ â”‚ åŒ…å« 3 å€‹è€å¸«æ˜ç¢ºæåˆ°çš„é‡é»         â”‚  â”‚
â”‚ â”‚ [æŸ¥çœ‹è©³æƒ…]                          â”‚  â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                          â”‚
â”‚ ğŸ“š å®Œæ•´èª²ç¨‹                               â”‚
â”‚ â—‹ æ•´å ‚èª²ç¨‹ (12 é¡Œ)                       â”‚
â”‚                                          â”‚
â”‚ ğŸ“– ä¾ç« ç¯€é¸æ“‡                             â”‚
â”‚ â—‹ 3.1 äºŒå…ƒæ¨¹çš„å®šç¾© (5 é¡Œ)               â”‚
â”‚ â—‹ 3.2 äºŒå…ƒæ¨¹çš„è¡¨ç¤ºæ³• (4 é¡Œ)             â”‚
â”‚ â—‹ 4.1 æ¨¹çš„èµ°è¨ª - å‰åºèµ°è¨ª (4 é¡Œ)        â”‚
â”‚                                          â”‚
â”‚ âš™ï¸ é¡Œå‹è¨­å®š                               â”‚
â”‚ é¸æ“‡é¡Œ: [3] å¡«å……é¡Œ: [2] ç°¡ç­”é¡Œ: [1]     â”‚
â”‚ é›£åº¦: â—‹ ç°¡å–® â— ä¸­ç­‰ â—‹ å›°é›£             â”‚
â”‚                                          â”‚
â”‚            [ç”Ÿæˆé¡Œç›®]                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é»æ“Šã€ŒæŸ¥çœ‹è©³æƒ…ã€å¾Œï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¯ è€å¸«èªªæœƒè€ƒçš„éƒ¨åˆ† - è©³æƒ…                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚ 1. [00:08:45] è¬›ç¾© p.3                  â”‚
â”‚    ã€Œé€™å€‹å®šç¾©å¾ˆé‡è¦ï¼Œè€ƒè©¦æœƒè€ƒã€           â”‚
â”‚    â†’ äºŒå…ƒæ¨¹å®šç¾©                          â”‚
â”‚    [è·³è½‰æ’­æ”¾]                            â”‚
â”‚                                          â”‚
â”‚ 2. [00:20:15] è¬›ç¾© p.7                  â”‚
â”‚    ã€Œæ³¨æ„é€™è£¡ï¼Œé™£åˆ—è¡¨ç¤ºæ³•çš„ç´¢å¼•é—œä¿‚...ã€  â”‚
â”‚    â†’ é™£åˆ—è¡¨ç¤ºæ³•                          â”‚
â”‚    [è·³è½‰æ’­æ”¾]                            â”‚
â”‚                                          â”‚
â”‚ 3. [00:35:20] è¬›ç¾© p.8                  â”‚
â”‚    ã€Œå‰åºèµ°è¨ªçš„é †åºä¸€å®šè¦è¨˜å¾—ï¼Œé€™å€‹å¸¸è€ƒã€ â”‚
â”‚    â†’ å‰åºèµ°è¨ª                            â”‚
â”‚    [è·³è½‰æ’­æ”¾]                            â”‚
â”‚                                          â”‚
â”‚            [ç¢ºå®šï¼Œç”Ÿæˆé¡Œç›®]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. è€å¸«é‡é»æç¤ºè¨˜éŒ„èˆ‡æœå°‹

### 2.1 åŠŸèƒ½æè¿°

åœ¨èª²å ‚èªéŸ³è½‰éŒ„éç¨‹ä¸­ï¼Œè‡ªå‹•è­˜åˆ¥ä¸¦è¨˜éŒ„è€å¸«çš„é‡é»æç¤ºèªï¼Œè®“å­¸ç”Ÿå¯ä»¥ï¼š
- å¿«é€Ÿæ‰¾åˆ°ã€Œè€å¸«èªªæœƒè€ƒçš„éƒ¨åˆ†ã€
- å•ã€Œè€å¸«ä¹‹å‰èªªä»€éº¼å¾ˆé‡è¦ã€
- æœå°‹ã€Œè€å¸«æåˆ°çš„å¸¸è¦‹éŒ¯èª¤ã€

### 2.2 è³‡æ–™åº« Schema æ›´æ–°

**æ–°å¢è¡¨ï¼šè€å¸«é‡é»æç¤º**

```sql
CREATE TABLE teacher_hints (
    id SERIAL PRIMARY KEY,
    course_id VARCHAR(50) REFERENCES courses(id),
    timestamp VARCHAR(20), -- HH:MM:SS
    hint_text TEXT, -- è€å¸«èªªçš„åŸæ–‡
    hint_type VARCHAR(20), -- exam, important, attention, common_mistake, reminder
    related_concept VARCHAR(255), -- ç›¸é—œæ¦‚å¿µ
    slide_page INT, -- å°æ‡‰è¬›ç¾©é ç¢¼
    confidence FLOAT, -- AI è­˜åˆ¥çš„ä¿¡å¿ƒåˆ†æ•¸ (0-1)
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ç´¢å¼•å„ªåŒ–
CREATE INDEX idx_teacher_hints_course ON teacher_hints(course_id);
CREATE INDEX idx_teacher_hints_type ON teacher_hints(hint_type);
```

**hint_type å®šç¾©ï¼š**
- `exam`: æ˜ç¢ºæåˆ°æœƒè€ƒè©¦ï¼ˆã€Œæœƒè€ƒã€ã€ã€Œè€ƒè©¦é‡é»ã€ã€ã€ŒæœŸä¸­è€ƒã€ï¼‰
- `important`: å¼·èª¿é‡è¦æ€§ï¼ˆã€Œå¾ˆé‡è¦ã€ã€ã€Œä¸€å®šè¦è¨˜å¾—ã€ã€ã€Œé—œéµã€ï¼‰
- `attention`: æé†’æ³¨æ„ï¼ˆã€Œæ³¨æ„é€™è£¡ã€ã€ã€Œå°å¿ƒã€ã€ã€Œè¦ç‰¹åˆ¥æ³¨æ„ã€ï¼‰
- `common_mistake`: å¸¸è¦‹éŒ¯èª¤ï¼ˆã€Œå¤§å®¶å¸¸çŠ¯çš„éŒ¯ã€ã€ã€Œæ³¨æ„ä¸è¦å¯«éŒ¯ã€ï¼‰
- `reminder`: æé†’è¤‡ç¿’ï¼ˆã€Œè¨˜å¾—è¤‡ç¿’ã€ã€ã€Œä¸‹æ¬¡è¦è€ƒã€ï¼‰

### 2.3 æ–°å¢ API ç«¯é»

#### 2.3.1 å–å¾—è€å¸«é‡é»æç¤ºåˆ—è¡¨

```
GET /courses/{course_id}/teacher-hints
```

**Query Parameters:**
- `hint_type`: (optional) ç¯©é¸é¡å‹ï¼Œä¾‹å¦‚ `exam`
- `limit`: (optional) é™åˆ¶å›å‚³æ•¸é‡ï¼Œé è¨­ 20

**Response:**
```json
{
  "hints": [
    {
      "id": 1,
      "timestamp": "00:08:45",
      "hint_text": "é€™å€‹å®šç¾©å¾ˆé‡è¦ï¼Œè€ƒè©¦æœƒè€ƒ",
      "hint_type": "exam",
      "related_concept": "äºŒå…ƒæ¨¹å®šç¾©",
      "slide_page": 3,
      "confidence": 0.95,
      "video_url": "https://drive.google.com/file/d/xxx?t=525"
    },
    {
      "id": 2,
      "timestamp": "00:20:15",
      "hint_text": "æ³¨æ„é€™è£¡ï¼Œå¤§å®¶å¸¸å¯«éŒ¯",
      "hint_type": "common_mistake",
      "related_concept": "é™£åˆ—ç´¢å¼•è¨ˆç®—",
      "slide_page": 7,
      "confidence": 0.88,
      "video_url": "https://drive.google.com/file/d/xxx?t=1215"
    }
  ],
  "total": 8,
  "by_type": {
    "exam": 3,
    "important": 2,
    "attention": 2,
    "common_mistake": 1
  }
}
```

#### 2.3.2 æ™ºæ…§æœå°‹ï¼ˆèªæ„æœå°‹ï¼‰

```
POST /courses/{course_id}/search
```

**èªªæ˜ï¼š** ä½¿ç”¨è€…å¯ä»¥ç”¨è‡ªç„¶èªè¨€å•å•é¡Œï¼ŒAI æœƒæœå°‹ç›¸é—œçš„èª²ç¨‹å…§å®¹å’Œè€å¸«æç¤ºã€‚

**Request Body:**
```json
{
  "query": "è€å¸«èªªå“ªè£¡æœƒè€ƒ",
  "search_scope": ["hints", "transcript", "slides"],  // æœå°‹ç¯„åœ
  "limit": 10
}
```

**Response:**
```json
{
  "results": [
    {
      "type": "teacher_hint",
      "relevance_score": 0.95,
      "content": {
        "timestamp": "00:08:45",
        "hint_text": "é€™å€‹å®šç¾©å¾ˆé‡è¦ï¼Œè€ƒè©¦æœƒè€ƒ",
        "hint_type": "exam",
        "related_concept": "äºŒå…ƒæ¨¹å®šç¾©",
        "slide_page": 3
      },
      "context": "è€å¸«åœ¨è¬›è§£äºŒå…ƒæ¨¹å®šç¾©æ™‚ï¼Œæ˜ç¢ºæåˆ°é€™å€‹æœƒè€ƒ"
    },
    {
      "type": "teacher_hint",
      "relevance_score": 0.92,
      "content": {
        "timestamp": "00:35:20",
        "hint_text": "å‰åºèµ°è¨ªçš„é †åºä¸€å®šè¦è¨˜å¾—ï¼Œé€™å€‹å¸¸è€ƒ",
        "hint_type": "exam",
        "related_concept": "å‰åºèµ°è¨ª",
        "slide_page": 8
      },
      "context": "è€å¸«å¼·èª¿å‰åºèµ°è¨ªæ˜¯å¸¸è€ƒé¡Œå‹"
    },
    {
      "type": "transcript",
      "relevance_score": 0.85,
      "content": {
        "timestamp": "00:42:10",
        "text": "æœŸä¸­è€ƒæœƒè€ƒæ¨¹çš„èµ°è¨ªï¼Œå¤§å®¶è¦å¤šç·´ç¿’",
        "slide_page": 9
      },
      "context": "è€å¸«æé†’æœŸä¸­è€ƒç¯„åœ"
    }
  ],
  "summary": "è€å¸«æåˆ° 3 å€‹æœƒè€ƒçš„é‡é»ï¼šäºŒå…ƒæ¨¹å®šç¾©ã€å‰åºèµ°è¨ªã€æ¨¹çš„èµ°è¨ªæ‡‰ç”¨"
}
```

#### 2.3.3 å¸¸è¦‹å•é¡Œå¿«æ·æœå°‹

```
GET /courses/{course_id}/quick-search?q={preset_query}
```

**é è¨­æŸ¥è©¢é¸é …ï¼š**
- `exam`: è€å¸«èªªæœƒè€ƒçš„éƒ¨åˆ†
- `important`: è€å¸«èªªå¾ˆé‡è¦çš„éƒ¨åˆ†
- `mistake`: è€å¸«æåˆ°çš„å¸¸è¦‹éŒ¯èª¤
- `review`: è€å¸«æé†’è¦è¤‡ç¿’çš„éƒ¨åˆ†

**ç¯„ä¾‹ï¼š**
```
GET /courses/course_123/quick-search?q=exam
```

**Response:**
```json
{
  "query": "è€å¸«èªªæœƒè€ƒçš„éƒ¨åˆ†",
  "results": [
    {
      "timestamp": "00:08:45",
      "content": "é€™å€‹å®šç¾©å¾ˆé‡è¦ï¼Œè€ƒè©¦æœƒè€ƒ",
      "related_concept": "äºŒå…ƒæ¨¹å®šç¾©",
      "slide_page": 3
    },
    {
      "timestamp": "00:35:20",
      "content": "å‰åºèµ°è¨ªçš„é †åºä¸€å®šè¦è¨˜å¾—ï¼Œé€™å€‹å¸¸è€ƒ",
      "related_concept": "å‰åºèµ°è¨ª",
      "slide_page": 8
    }
  ],
  "count": 3
}
```

### 2.4 å¯¦æ™‚æç¤ºèªè­˜åˆ¥

**åœ¨ WebSocket è½‰éŒ„éç¨‹ä¸­è­˜åˆ¥æç¤ºèªï¼š**

```python
# å¾Œç«¯ WebSocket handler æ›´æ–°
async def process_transcript(course_id: str, timestamp: str, text: str):
    # 1. å„²å­˜è½‰éŒ„æ–‡å­—
    await db.save_transcript(course_id, timestamp, text)

    # 2. æª¢æŸ¥æ˜¯å¦åŒ…å«æç¤ºèª
    hint_patterns = {
        'exam': ['æœƒè€ƒ', 'è€ƒè©¦', 'æœŸä¸­è€ƒ', 'æœŸæœ«è€ƒ', 'è€ƒè©¦é‡é»', 'å¿…è€ƒ'],
        'important': ['å¾ˆé‡è¦', 'é‡é»', 'ä¸€å®šè¦', 'é—œéµ', 'æ ¸å¿ƒ'],
        'attention': ['æ³¨æ„', 'å°å¿ƒ', 'è¦ç‰¹åˆ¥', 'ç•™æ„'],
        'common_mistake': ['å¸¸éŒ¯', 'å¸¸çŠ¯', 'å®¹æ˜“éŒ¯', 'å¤§å®¶éƒ½', 'æ³¨æ„ä¸è¦'],
        'reminder': ['è¨˜å¾—', 'è¦è¤‡ç¿’', 'å›å»çœ‹', 'ä¸‹æ¬¡']
    }

    for hint_type, patterns in hint_patterns.items():
        for pattern in patterns:
            if pattern in text:
                # ä½¿ç”¨ LLM é€²ä¸€æ­¥åˆ†ææç¤ºçš„å…§å®¹
                hint_analysis = await analyze_teacher_hint(text, timestamp)

                # å„²å­˜è€å¸«æç¤º
                await db.save_teacher_hint(
                    course_id=course_id,
                    timestamp=timestamp,
                    hint_text=text,
                    hint_type=hint_type,
                    related_concept=hint_analysis['concept'],
                    slide_page=hint_analysis['slide_page'],
                    confidence=hint_analysis['confidence']
                )

                # å³æ™‚é€šçŸ¥å‰ç«¯
                await websocket.send_json({
                    "type": "teacher_hint",
                    "timestamp": timestamp,
                    "hint_type": hint_type,
                    "text": text
                })

                break
```

**LLM åˆ†ææç¤ºå…§å®¹ï¼š**

```python
async def analyze_teacher_hint(hint_text: str, timestamp: str):
    prompt = f"""
    åˆ†æä»¥ä¸‹è€å¸«çš„æç¤ºèªï¼Œè­˜åˆ¥ç›¸é—œæ¦‚å¿µã€‚

    æç¤ºèªï¼š{hint_text}
    æ™‚é–“é»ï¼š{timestamp}

    è«‹å›ç­”ï¼š
    1. é€™å€‹æç¤ºèˆ‡å“ªå€‹æ¦‚å¿µç›¸é—œï¼Ÿ
    2. å¯èƒ½å°æ‡‰åˆ°è¬›ç¾©çš„å“ªä¸€é ï¼Ÿï¼ˆæ ¹æ“šä¸Šä¸‹æ–‡æ¨æ¸¬ï¼‰

    å›å‚³ JSONï¼š
    {{
      "concept": "æ¦‚å¿µåç¨±",
      "slide_page": é ç¢¼æˆ–null,
      "confidence": ä¿¡å¿ƒåˆ†æ•¸
    }}
    """

    response = await llm_client.generate(prompt)
    return parse_json(response)
```

### 2.5 å‰ç«¯å´é‚Šæ¬„æ›´æ–°

**å³æ™‚é¡¯ç¤ºè€å¸«æç¤ºï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CourseAI ğŸ“               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¤ å³æ™‚è½‰éŒ„                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [00:08:45]          â”‚   â”‚
â”‚  â”‚ è€å¸«ï¼šé€™å€‹å®šç¾©å¾ˆé‡è¦ â”‚   â”‚
â”‚  â”‚ ï¼Œè€ƒè©¦æœƒè€ƒ          â”‚   â”‚
â”‚  â”‚ â­ æœƒè€ƒé‡é»ï¼        â”‚   â”‚  â† è‡ªå‹•æ¨™è¨˜
â”‚  â”‚                     â”‚   â”‚
â”‚  â”‚ [00:20:15]          â”‚   â”‚
â”‚  â”‚ è€å¸«ï¼šæ³¨æ„é€™è£¡...   â”‚   â”‚
â”‚  â”‚ âš ï¸ æ³¨æ„äº‹é …         â”‚   â”‚  â† è‡ªå‹•æ¨™è¨˜
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                             â”‚
â”‚  ğŸ¯ æœ¬å ‚é‡é»æç¤º (3)        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â­ æœƒè€ƒ: 2 å€‹        â”‚   â”‚
â”‚  â”‚ âš ï¸ æ³¨æ„: 1 å€‹        â”‚   â”‚
â”‚  â”‚ [æŸ¥çœ‹å…¨éƒ¨]           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ” å¿«é€Ÿæœå°‹                â”‚
â”‚  [è€å¸«èªªå“ªè£¡æœƒè€ƒï¼Ÿ] ğŸ”      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é»æ“Šã€ŒæŸ¥çœ‹å…¨éƒ¨ã€å±•é–‹ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ¯ æœ¬å ‚èª²é‡é»æç¤º                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚ â­ æœƒè€ƒ (2 å€‹)                   â”‚
â”‚ â€¢ [00:08:45] äºŒå…ƒæ¨¹å®šç¾© (p.3)   â”‚
â”‚   [è·³è½‰] [åŠ å…¥é¡Œç›®ç¯„åœ]          â”‚
â”‚                                  â”‚
â”‚ â€¢ [00:35:20] å‰åºèµ°è¨ª (p.8)     â”‚
â”‚   [è·³è½‰] [åŠ å…¥é¡Œç›®ç¯„åœ]          â”‚
â”‚                                  â”‚
â”‚ âš ï¸ æ³¨æ„ (1 å€‹)                   â”‚
â”‚ â€¢ [00:20:15] é™£åˆ—ç´¢å¼• (p.7)     â”‚
â”‚   [è·³è½‰]                         â”‚
â”‚                                  â”‚
â”‚      [å…¨éƒ¨åŠ å…¥é¡Œç›®ç¯„åœ]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.6 æœå°‹åŠŸèƒ½ UI

**åœ¨ Popup ä¸­æ–°å¢æœå°‹é é¢ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” æ™ºæ…§æœå°‹                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                  â”‚
â”‚ [è¼¸å…¥å•é¡Œæˆ–é—œéµå­—...]  [æœå°‹]   â”‚
â”‚                                  â”‚
â”‚ ğŸ’¡ å¸¸è¦‹å•é¡Œï¼š                     â”‚
â”‚ â€¢ è€å¸«èªªå“ªè£¡æœƒè€ƒï¼Ÿ                â”‚
â”‚ â€¢ è€å¸«æåˆ°çš„å¸¸è¦‹éŒ¯èª¤               â”‚
â”‚ â€¢ è€å¸«èªªä»€éº¼å¾ˆé‡è¦ï¼Ÿ              â”‚
â”‚ â€¢ æœŸä¸­è€ƒæœƒè€ƒä»€éº¼ï¼Ÿ                â”‚
â”‚                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ æœå°‹çµæœ                       â”‚
â”‚                                  â”‚
â”‚ 1. [00:08:45] è€å¸«æç¤º           â”‚
â”‚    ã€Œé€™å€‹å®šç¾©å¾ˆé‡è¦ï¼Œè€ƒè©¦æœƒè€ƒã€   â”‚
â”‚    â†’ äºŒå…ƒæ¨¹å®šç¾© (è¬›ç¾© p.3)       â”‚
â”‚    [æ’­æ”¾] [æŸ¥çœ‹è¬›ç¾©]             â”‚
â”‚                                  â”‚
â”‚ 2. [00:35:20] è€å¸«æç¤º           â”‚
â”‚    ã€Œå‰åºèµ°è¨ªçš„é †åºä¸€å®šè¦è¨˜å¾—...ã€â”‚
â”‚    â†’ å‰åºèµ°è¨ª (è¬›ç¾© p.8)         â”‚
â”‚    [æ’­æ”¾] [æŸ¥çœ‹è¬›ç¾©]             â”‚
â”‚                                  â”‚
â”‚ ğŸ’¡ AI å»ºè­°ï¼š                     â”‚
â”‚ è€å¸«æåˆ° 3 å€‹æœƒè€ƒé‡é»ï¼Œå»ºè­°å„ªå…ˆ   â”‚
â”‚ è¤‡ç¿’é€™äº›å…§å®¹ä¸¦ç·´ç¿’ç›¸é—œé¡Œç›®ã€‚      â”‚
â”‚                                  â”‚
â”‚      [æ ¹æ“šçµæœç”Ÿæˆé¡Œç›®]           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. å¯¦ä½œå„ªå…ˆé †åº

### éšæ®µä¸€ï¼šåŸºç¤åŠŸèƒ½ï¼ˆMVPï¼‰
1. âœ… å³æ™‚è½‰éŒ„
2. âœ… è¬›ç¾©ä¸Šå‚³
3. âœ… åŸºæœ¬é¡Œç›®ç”Ÿæˆ
4. **æ–°å¢ï¼šè€å¸«æç¤ºèªå³æ™‚è­˜åˆ¥ï¼ˆåŸºç¤ç‰ˆï¼‰**
   - åªè­˜åˆ¥ã€Œæœƒè€ƒã€ã€ã€Œé‡è¦ã€ã€ã€Œæ³¨æ„ã€
   - ç°¡å–®çš„é—œéµå­—åŒ¹é…

### éšæ®µäºŒï¼šå®Œæ•´åŠŸèƒ½
1. **ç´°ç·»ç¯„åœåˆ†é¡**
   - LLM åˆ†æç« ç¯€çµæ§‹
   - è‡ªå‹•å»ºè­°ç¯„åœé¸é …
2. **è€å¸«æç¤ºè¨˜éŒ„å®Œæ•´ç‰ˆ**
   - 5 ç¨®æç¤ºé¡å‹å®Œæ•´è­˜åˆ¥
   - LLM åˆ†ææç¤ºå…§å®¹
   - å»ºç«‹æç¤ºè³‡æ–™åº«
3. **åŸºç¤æœå°‹**
   - å¿«æ·æœå°‹ï¼ˆé è¨­å•é¡Œï¼‰
   - æç¤ºåˆ—è¡¨æŸ¥çœ‹

### éšæ®µä¸‰ï¼šé€²éšåŠŸèƒ½
1. **æ™ºæ…§èªæ„æœå°‹**
   - è‡ªç„¶èªè¨€å•ç­”
   - AI å½™æ•´æœå°‹çµæœ
   - æœå°‹çµæœæ’åºå„ªåŒ–
2. **æç¤ºé©…å‹•å­¸ç¿’**
   - æ ¹æ“šæç¤ºè‡ªå‹•ç”¢ç”Ÿè¤‡ç¿’è¨ˆç•«
   - æç¤ºèˆ‡é¡Œç›®çš„é—œè¯åˆ†æ

---

## 4. æŠ€è¡“ç´°ç¯€è£œå……

### 4.1 è€å¸«æç¤ºèªè­˜åˆ¥çš„æŒ‘æˆ°

**æŒ‘æˆ°ï¼š**
1. å£èªåŒ–è¡¨é”å¤šæ¨£ï¼ˆã€Œé€™å€‹è¦è¨˜ã€vsã€Œè¦è¨˜å¾—é€™å€‹ã€ï¼‰
2. å¯èƒ½æœ‰èªéŸ³è¾¨è­˜éŒ¯èª¤
3. éœ€è¦ç†è§£ä¸Šä¸‹æ–‡ï¼ˆã€Œé€™å€‹ã€æŒ‡çš„æ˜¯ä»€éº¼ï¼‰

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. å»ºç«‹å®Œæ•´çš„æç¤ºèªè©åº«ï¼ˆå«åŒç¾©è©ï¼‰
2. ä½¿ç”¨ LLM ç†è§£ä¸Šä¸‹æ–‡ï¼Œè­˜åˆ¥ã€Œé€™å€‹ã€çš„æŒ‡ç¨±
3. çµåˆè¬›ç¾©å…§å®¹ï¼Œæ¨æ¸¬å°æ‡‰çš„æ¦‚å¿µ
4. è¨­å®šä¿¡å¿ƒåˆ†æ•¸é–¾å€¼ï¼ˆ< 0.7 éœ€äººå·¥ç¢ºèªï¼‰

### 4.2 ç¯„åœåˆ†é¡çš„æº–ç¢ºæ€§

**æŒ‘æˆ°ï¼š**
1. è¬›ç¾©çµæ§‹ä¸ä¸€å®šæ¸…æ¥šï¼ˆç¼ºå°‘æ¨™é¡Œç·¨è™Ÿï¼‰
2. è€å¸«ä¸Šèª²é †åºå¯èƒ½è·³èº

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. ä½¿ç”¨ LLM åˆ†æè¬›ç¾©çš„è¦–è¦ºçµæ§‹ï¼ˆå­—é«”å¤§å°ã€ç²—é«”ï¼‰
2. çµåˆèªéŸ³è½‰éŒ„çš„æ™‚é–“åˆ†å¸ƒï¼Œæ¨æ¸¬å–®å…ƒåŠƒåˆ†
3. å…è¨±è€å¸«/å­¸ç”Ÿæ‰‹å‹•èª¿æ•´ç¯„åœ
4. æä¾›ä¿¡å¿ƒåˆ†æ•¸ï¼Œè®“ä½¿ç”¨è€…åˆ¤æ–·

### 4.3 æ•ˆèƒ½å„ªåŒ–

**å³æ™‚è­˜åˆ¥å„ªåŒ–ï¼š**
- æç¤ºèªè­˜åˆ¥åœ¨å‰ç«¯å…ˆç”¨é—œéµå­—éæ¿¾
- åªæœ‰åŒ¹é…åˆ°é—œéµå­—æ‰é€å¾Œç«¯ LLM åˆ†æ
- æ¸›å°‘ä¸å¿…è¦çš„ API å‘¼å«

**æœå°‹å„ªåŒ–ï¼š**
- å¸¸è¦‹å•é¡Œçš„æœå°‹çµæœå¿«å–
- ä½¿ç”¨å‘é‡è³‡æ–™åº«ï¼ˆå¦‚ Pineconeï¼‰åŠ é€Ÿèªæ„æœå°‹
- å»ºç«‹å€’æ’ç´¢å¼•åŠ é€Ÿé—œéµå­—æœå°‹

---

## 5. ä½¿ç”¨æƒ…å¢ƒç¯„ä¾‹

### æƒ…å¢ƒä¸€ï¼šèª²å¾Œç«‹å³è¤‡ç¿’

1. å­¸ç”Ÿä¸‹èª²å¾Œæ‰“é–‹å¤–æ›
2. å´é‚Šæ¬„é¡¯ç¤ºï¼šã€Œæœ¬å ‚èª²æœ‰ 3 å€‹è€å¸«èªªæœƒè€ƒçš„é‡é»ã€
3. é»æ“Šã€ŒæŸ¥çœ‹å…¨éƒ¨ã€ï¼Œçœ‹åˆ°ï¼š
   - äºŒå…ƒæ¨¹å®šç¾©ï¼ˆ00:08:45ï¼‰
   - é™£åˆ—ç´¢å¼•è¨ˆç®—ï¼ˆ00:20:15ï¼‰
   - å‰åºèµ°è¨ªé †åºï¼ˆ00:35:20ï¼‰
4. é»æ“Šã€Œå…¨éƒ¨åŠ å…¥é¡Œç›®ç¯„åœã€
5. ç”Ÿæˆ 6 é¡Œé‡å°é€™äº›é‡é»çš„é¡Œç›®
6. ç«‹å³ç·´ç¿’ï¼Œç­”éŒ¯çš„é¡Œç›®å¯é»æ“Šè·³å›éŒ„å½±é‡çœ‹

### æƒ…å¢ƒäºŒï¼šè€ƒå‰è¤‡ç¿’

1. å­¸ç”Ÿåœ¨è€ƒå‰ä¸€å¤©æ‰“é–‹å¤–æ›
2. åœ¨æœå°‹æ¬„è¼¸å…¥ï¼šã€Œè€å¸«èªªæœŸä¸­è€ƒæœƒè€ƒä»€éº¼ã€
3. ç³»çµ±æœå°‹æ‰€æœ‰èª²ç¨‹ï¼Œåˆ—å‡ºï¼š
   - Week 3: äºŒå…ƒæ¨¹å®šç¾©ã€èµ°è¨ªæ–¹æ³•
   - Week 5: å¹³è¡¡æ¨¹çš„æ—‹è½‰
   - Week 7: åœ–çš„æœ€çŸ­è·¯å¾‘
4. é»æ“Šã€Œæ ¹æ“šçµæœç”Ÿæˆç¶œåˆé¡Œç›®ã€
5. ç³»çµ±ç”¢ç”Ÿè·¨é€±æ¬¡çš„ç¶œåˆé¡Œç›®
6. é‡é»è¤‡ç¿’è€å¸«å¼·èª¿çš„å…§å®¹

### æƒ…å¢ƒä¸‰ï¼šæ‰¾ä¸åˆ°ç­†è¨˜æ™‚

1. å­¸ç”Ÿè¨˜å¾—è€å¸«èªªéæŸå€‹å¸¸è¦‹éŒ¯èª¤ï¼Œä½†å¿˜è¨˜æ˜¯å“ªè£¡
2. è¼¸å…¥ï¼šã€Œè€å¸«èªªå¤§å®¶å¸¸çŠ¯çš„éŒ¯ã€
3. ç³»çµ±åˆ—å‡ºæ‰€æœ‰ `common_mistake` é¡å‹çš„æç¤º
4. æ‰¾åˆ°ç›®æ¨™æç¤ºï¼Œè·³è½‰åˆ°éŒ„å½±é‡çœ‹
5. æŸ¥çœ‹å°æ‡‰è¬›ç¾©é ï¼Œé‡æ–°ç†è§£

---

**æ–‡ä»¶ç‰ˆæœ¬è¨˜éŒ„ï¼š**
- v1.1 (2024-11-17): æ–°å¢ç´°ç·»ç¯„åœåˆ†é¡ã€è€å¸«æç¤ºè¨˜éŒ„ã€æ™ºæ…§æœå°‹åŠŸèƒ½
